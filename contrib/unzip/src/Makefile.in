##
# unzip Makefile fragment
##

.PHONY: ${unzip}_clean

.SUFFIXES: .c

unzip_src = contrib/unzip/src
unzip_obj = contrib/unzip/src/.build

unzip_cflags := -W -Wmissing-format-attribute -Wpointer-arith -Wcast-align
unzip_cflags += -Wwrite-strings -Wno-unused-parameter
unzip_cflags += -I${unzip_src} -DNOUNCRYPT

unzip_objs = ${unzip_obj}/unzip.o ${unzip_obj}/ioapi.o

${unzip_obj}/%.o: ${unzip_src}/%.c
ifeq (${V},1)
	${HOST_CC} -MD ${CFLAGS} ${unzip_cflags} \
	                         -I${PREFIX}/include -c $< -o $@
else
	@echo "  HOST_CC " $<
	@${HOST_CC} -MD ${CFLAGS} ${unzip_cflags} \
	                         -I${PREFIX}/include -c $< -o $@
endif

-include $(unzip_objs:.o=.d)

${unzip_objs}: $(filter-out $(wildcard ${unzip_obj}), ${unzip_obj})

unzip_clean:
	@echo "  RM      " ${unzip_obj}
	@rm -rf ${unzip_obj}
