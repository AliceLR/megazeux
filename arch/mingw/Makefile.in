#
# mingw makefile generics
#

CC      = ${MINGWBASE}gcc
CXX     = ${MINGWBASE}g++
AR      = ${MINGWBASE}ar
OBJCOPY = ${MINGWBASE}objcopy
STRIP   = ${MINGWBASE}strip --strip-unneeded
WINDRES = ${MINGWBASE}windres

BINEXT  = .exe

DSOLDFLAGS = -shared
DSOPRE     =
DSOPOST    = .dll
DSORPATH   =
DSOSONAME  = -Wl,-soname,

# OpenGL must be linked to MZX
core_flags   += -DLINK_OPENGL
core_ldflags += -lopengl32

# Windows needs PNG to be statically linked (inc. zlib)
LIBPNG_LDFLAGS = `libpng12-config --static --ldflags`

#
# Windows builds must copy SDL.dll and create a directx.bat
#
build: ${build}
	${CP} ${shell sdl-config --prefix}/bin/SDL.dll ${build}
	${shell echo set SDL_VIDEODRIVER=directx > ${build}/directx.bat}
	${shell echo start megazeux.exe >> ${build}/directx.bat}

SUBARCH := ${shell echo ${SUBPLATFORM} | sed 's,windows-,,'}
include arch/zip.inc 
